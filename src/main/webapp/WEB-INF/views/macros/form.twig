{% import _self as forms %}

{% macro input(name, value, type, size) %}
  <input type="{{ type|default('text') }}" name="{{ name }}" value="{{ value|e }}" size="{{ size|default(20) }}" />
{% endmacro %}

{% macro text(name, value, editable, label, size) %}
    <label> {{ label |default("") |e }}
        <input type="text" name="{{ name }}"
               {% if (editable) %}{% else %}
                    disabled
               {% endif %}
               value="{{ value|e }}" size="{{ size|default(20) }}" />
    </label>
{% endmacro %}

{% macro date(name, value, editable, label) %}
    <label> {{ label |default("") |e }}
        <input type="date" name="{{ name }}"
               {% if (editable) %}{% else %}
                    disabled
               {% endif %}
               value="{{ value |date("yyyy-MM-dd") }}" />
    </label>
{% endmacro %}

{% macro datetime(name, value, editable, label) %}
  {#  <label> {{ label |default("") |e }}
        <input type="datetime-local" name="{{ name }}"
               {% if (editable) %}{% else %}
                    disabled
               {% endif %}
               value="{{ value |date("yyyy-MM-dd\THH:mm:ss") }}" />
    </label>#}
    <label> {{ label |default("") |e }}
        <input type="text" name="{{ name }}"
                {% if (editable) %}{% else %}
                    disabled
                {% endif %}
               value="{{ value |date("yyyy-MM-dd HH:mm:ss") }}" />
    </label>
{% endmacro %}

{% macro time(name, value, editable, label) %}
    <label> {{ label |default("") |e }}
        <input type="time" name="{{ name }}"
               {% if (editable) %}{% else %}
                    disabled
               {% endif %}
               value="{{ value |date("HH:mm:ss") }}"  />
    </label>
{% endmacro %}

{% macro decimal(name, value, editable, label, size) %}
    <label> {{ label |default("") |e }}
        <input type="number" name="{{ name }}"
               {% if (editable) %}{% else %}
                    disabled
               {% endif %}
               value="{{ value | e }}" size="{{ size|default(10) }}" />
    </label>
{% endmacro %}

{% macro integer(name, value, editable, label, size) %}
    <label> {{ label |default("") |e }}
        <input type="number" name="{{ name }}"
               {% if (editable) %}{% else %}
                    disabled
               {% endif %}
               value="{{ value | e }}" size="{{ size|default(10) }}" />
    </label>
{% endmacro %}

{% macro formMeta(form) %}
    <table>
        <tr>
            <td>filled at:</td>
            <td>{{ form.filledAt }}</td>
        </tr>
        <tr>
            <td>approved at:</td>
            <td>{{ form.approvedAt }}</td>
        </tr>
        <tr>
            <td>approved by:</td>
            <td>{{ form.admin }}</td>
        </tr>
    </table>
{% endmacro %}

{% macro fieldField(filledField, editable) %}
    {% set type = filledField.field.fieldType |fieldtype %}
    <div>
    {% if type == "date" %}
        {{ forms.date(filledField.field.name,  filledField.data, editable, filledField.field.label ) }}
    {% endif %}
    {% if type == "datetime" %}
        {{ forms.datetime(filledField.field.name,  filledField.data, editable, filledField.field.label ) }}
    {% endif %}
    {% if type == "time" %}
        {{ forms.time(filledField.field.name,  filledField.data, editable, filledField.field.label ) }}
    {% endif %}
    {% if type == "decimal" %}
        {{ forms.decimal(filledField.field.name,  filledField.data, editable, filledField.field.label ) }}
    {% endif %}
    {% if type == "integer" %}
        {{ forms.integer(filledField.field.name,  filledField.data, editable, filledField.field.label ) }}
    {% endif %}
    {% if type == "text" %}
        {{ forms.text(filledField.field.name,  filledField.data, editable, filledField.field.label ) }}
    {% endif %}
    <p>{{ filledField.field.publicDescription }}</p>
    </div>
{% endmacro %}
